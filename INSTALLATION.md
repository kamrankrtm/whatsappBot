# راهنمای نصب و راه‌اندازی بات واتساپ (با ذخیره‌سازی فایلی)

این راهنما نحوه نصب و راه‌اندازی برنامه بات واتساپ با استفاده از سیستم ذخیره‌سازی فایلی (به جای پایگاه داده) را توضیح می‌دهد.

## پیش‌نیازها

- Node.js نسخه 16 یا بالاتر
- NPM نسخه 8 یا بالاتر
- اتصال اینترنت

## مراحل نصب

### 1. دانلود کد

```bash
git clone https://github.com/your-repository/whatsapp-bot.git
cd whatsapp-bot
```

### 2. نصب وابستگی‌ها

```bash
npm install
```

### 3. پیکربندی سیستم ذخیره‌سازی فایلی

به منظور استفاده از سیستم ذخیره‌سازی فایلی، یکی از روش‌های زیر را انتخاب کنید:

#### روش 1: حذف یا تغییر متغیرهای محیطی پایگاه داده
فایل `.env` را ویرایش کنید و متغیرهای محیطی مربوط به پایگاه داده را حذف یا تغییر دهید:

```
# متغیرهای محیطی پایگاه داده (برای استفاده از ذخیره‌سازی فایلی، این مقادیر را حذف یا تغییر دهید)
DB_HOST=incorrect-host
DB_NAME=incorrect-name
DB_USER=
DB_PASSWORD=
```

#### روش 2: ویرایش مستقیم فایل database.js
می‌توانید فایل `database.js` را ویرایش کنید تا همیشه null برگرداند و از سیستم فایلی استفاده کند.

### 4. اجرای برنامه

```bash
npm start
```

برنامه روی پورت 3000 (یا پورت تعیین شده در متغیر محیطی PORT) اجرا خواهد شد.

## نحوه استفاده

پس از راه‌اندازی موفقیت‌آمیز، می‌توانید:

1. به داشبورد مدیریت در آدرس `http://localhost:3000` مراجعه کنید
2. یک بات جدید ایجاد کنید
3. کد QR را اسکن کنید تا به واتساپ متصل شوید
4. از بات استفاده کنید!

## پوشه storage

پوشه `storage` به طور خودکار در مسیر اصلی برنامه ایجاد می‌شود. این پوشه شامل:

- `bot_configs.json`: تنظیمات بات‌های شما

برای تهیه نسخه پشتیبان، کافی است از این پوشه کپی بگیرید.

## استقرار در Liara

برای استقرار در Liara، مراحل زیر را دنبال کنید:

1. اطمینان حاصل کنید که سیستم ذخیره‌سازی فایلی به درستی پیکربندی شده است
2. فایل `liara.json` را بررسی کنید تا اطمینان حاصل کنید که دایرکتوری `storage` در تنظیمات volume قرار دارد:

```json
{
  "platform": "node",
  "app": "your-whatsapp-bot",
  "port": 3000,
  "disks": [
    {
      "name": "data",
      "mountTo": "/app/storage"
    }
  ]
}
```

3. با استفاده از دستور زیر پروژه را دیپلوی کنید:

```bash
liara deploy
```

## عیب‌یابی

اگر با مشکل مواجه شدید:

1. مطمئن شوید که پوشه `storage` وجود دارد و قابل نوشتن است
2. لاگ‌ها را برای پیدا کردن خطاهای احتمالی بررسی کنید:
   ```bash
   npm start > app.log 2>&1
   ```
3. اگر فایل `bot_configs.json` آسیب دیده، آن را با یک آرایه خالی `[]` جایگزین کنید
4. اگر به کمک بیشتری نیاز دارید، به [FILE_STORAGE_README.md](./FILE_STORAGE_README.md) مراجعه کنید 